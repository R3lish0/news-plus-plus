---
import { getCollection } from "astro:content";
import ArticleLayout from "../layouts/ArticleLayout.astro";
import Press from "../components/Press.astro";

const allArticles = await getCollection("article");

// Sort by date to get the latest
allArticles.sort((a, b) => {
  const dateA = new Date(a.data.date).getTime();
  const dateB = new Date(b.data.date).getTime();
  return dateB - dateA;
});

const latestArticle = allArticles[0];

if (!latestArticle) {
  return new Response("No articles found", { status: 404 });
}
---

<ArticleLayout 
    title={latestArticle.data.title} 
    img={latestArticle.data.img}
    currentSlug={latestArticle.slug}
>
    <Press article={latestArticle} isNewest={true} />
</ArticleLayout>
