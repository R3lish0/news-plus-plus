---
import { getCollection } from "astro:content";

const allArticles = await getCollection("article");

// Filter out about page and sort by date to get the latest
const regularArticles = allArticles.filter(article => article.slug !== 'about');
regularArticles.sort((a, b) => {
  const dateA = new Date(a.data.date).getTime();
  const dateB = new Date(b.data.date).getTime();
  return dateB - dateA;
});

const latestArticle = regularArticles[0];

if (latestArticle) {
  return Astro.redirect(`${import.meta.env.BASE_URL}posts/${latestArticle.slug}`);
} else {
  // Fallback if no articles exist
  return new Response("No articles found", { status: 404 });
}
---
